"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[302],{8302:(t,e,i)=>{i.d(e,{afterInsert:()=>a,searchWithHighlight:()=>c});var o=i(8690),n=i(2319);async function a(t,e){"positions"in t.data||Object.assign(t.data,{positions:{}}),await r(t,await t.documentsStore.get(t.data.docs,e),e)}var s=/[\p{L}0-9_'-]+/gimu;async function r(t,e,i,o="",n=t.schema){for(let a of(t.data.positions[i]=Object.create(null),Object.keys(e))){let c="object"==typeof e[a],l="object"==typeof n[a],f=`${o}${String(a)}`;if(c&&a in n&&l&&r(t,e[a],i,f+".",n[a]),!("string"==typeof e[a]&&a in n&&!l))continue;t.data.positions[i][f]=Object.create(null);let h=e[a],p;for(;null!==(p=s.exec(h));){let e=p[0].toLowerCase(),o=`${t.tokenizer.language}:${e}`,n;t.tokenizer.normalizationCache.has(o)?n=t.tokenizer.normalizationCache.get(o):([n]=t.tokenizer.tokenize(e),t.tokenizer.normalizationCache.set(o,n)),Array.isArray(t.data.positions[i][f][n])||(t.data.positions[i][f][n]=[]);let a=p.index,s=p[0].length;t.data.positions[i][f][n].push({start:a,length:s})}}}async function c(t,e,i){let a=await (0,o.$P)(t,e,i),s=t.tokenizer.tokenize(e.term??"",i),r=[];for(let i of a.hits){let o=Object.entries(t.data.positions[i.id]),a=[];for(let[t,i]of o){let o=[];for(let t of Object.entries(i)){let[i]=t;for(let a of s)if(e.tolerance){if((0,n.X1)(i,a,e.tolerance).isBounded){o.push(t);break}}else if(i.startsWith(a)){o.push(t);break}}a.push([t,Object.fromEntries(o)])}r.push(Object.assign(i,{positions:Object.fromEntries(a)}))}return a.hits=r,a}}}]);
<!DOCTYPE html><html lang="en" class="__variable_7c3f16 __variable_6c6f2f __variable_988d07"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/4de1fea1a954a5b6-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/6d664cce900333ee-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/cb0a9ee3a59e8bf7-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/df99695897be762b-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/e2fbf83149064d67.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/54406936ac53aaa7.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-0f1fd53fa6282c30.js"/><script src="/_next/static/chunks/fd9d1056-279a25513bd38037.js" async=""></script><script src="/_next/static/chunks/23-d79b58f35d395508.js" async=""></script><script src="/_next/static/chunks/main-app-e3d2ea454fa6bb70.js" async=""></script><script src="/_next/static/chunks/363642f4-9e72429e661e47fa.js" async=""></script><script src="/_next/static/chunks/e58a7f8f-3e17ebe2d129a781.js" async=""></script><script src="/_next/static/chunks/173-26eb077acb4f64fe.js" async=""></script><script src="/_next/static/chunks/459-ba55fbbe75738db5.js" async=""></script><script src="/_next/static/chunks/231-c1c00e13a9884adf.js" async=""></script><script src="/_next/static/chunks/app/layout-248d866a3f57725c.js" async=""></script><script src="/_next/static/chunks/app/page-91bc2a8110eb7406.js" async=""></script><script src="/_next/static/chunks/app/posts/%5Bid%5D/page-540fdedccf18a6b4.js" async=""></script><title>How to write a minimal code editor · satya164&#x27;s blog</title><meta name="description" content="Writing a code editor is a complex task. But what if there was an alternative approach for simpler use cases?"/><meta property="og:title" content="How to write a minimal code editor"/><meta property="og:description" content="Writing a code editor is a complex task. But what if there was an alternative approach for simpler use cases?"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2023-11-16T00:00:00.000Z"/><meta property="article:author" content="Satyajit Sahoo"/><meta name="twitter:card" content="summary"/><meta name="twitter:creator" content="@satya164"/><meta name="twitter:title" content="How to write a minimal code editor"/><meta name="twitter:description" content="Writing a code editor is a complex task. But what if there was an alternative approach for simpler use cases?"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><meta name="next-size-adjust"/><script>
  const theme = (function l(){return localStorage.getItem("selected-theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")})();

  document.documentElement.dataset.theme = theme;
</script><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script><style id="sandpack">--sxs{--sxs:0 sp-2099534210}@media{.sp-2099534210{--sp-space-1:4px;--sp-space-2:8px;--sp-space-3:12px;--sp-space-4:16px;--sp-space-5:20px;--sp-space-6:24px;--sp-space-7:28px;--sp-space-8:32px;--sp-space-9:36px;--sp-space-10:40px;--sp-space-11:44px;--sp-border-radius:4px;--sp-layout-height:300px;--sp-layout-headerHeight:40px;--sp-transitions-default:150ms ease;--sp-zIndices-base:1;--sp-zIndices-overlay:2;--sp-zIndices-top:3;--sp-colors-surface1:#292d3e;--sp-colors-surface2:#35384a;--sp-colors-surface3:#404251;--sp-colors-disabled:#858591;--sp-colors-base:#ffffff;--sp-colors-clickable:#acafc3;--sp-colors-hover:#ffffff;--sp-colors-accent:#db537d;--sp-colors-error:#ffffff;--sp-colors-errorSurface:#3b3b4f;--sp-colors-warning:#E7C400;--sp-colors-warningSurface:#3A3000;--sp-font-body:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";--sp-font-mono:"Fira Code", "Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace;--sp-font-size:12px;--sp-font-lineHeight:18px;--sp-syntax-color-plain:#babed8;--sp-syntax-color-comment:#676e95;--sp-syntax-color-keyword:#89ddff;--sp-syntax-color-tag:#f07178;--sp-syntax-color-punctuation:#89ddff;--sp-syntax-color-definition:#82aaff;--sp-syntax-color-property:#ffcb6b;--sp-syntax-color-static:#f07178;--sp-syntax-color-string:#c3e88d}}--sxs{--sxs:1 sp-k-eyOShd sp-k-iOHdLQ}@media{@keyframes sp-k-eyOShd{0%{opacity:0}100%{opacity:1}}@keyframes sp-k-iOHdLQ{0%{transform:rotateX(-25.5deg) rotateY(45deg)}100%{transform:rotateX(-25.5deg) rotateY(405deg)}}}--sxs{--sxs:2 sp-c-gMfcns sp-c-bxeRRt sp-c-hfoyCM sp-c-fWymNx sp-c-euXojQ sp-c-bpmgvy sp-c-PJLV sp-c-fVPbOs sp-c-ikJbEZ sp-c-gtcpyq sp-c-jOWzsE sp-c-jkvvao sp-c-juMdfR sp-c-fgviib sp-c-kwibBT sp-c-dEbKhQ}@media{.sp-c-gMfcns svg{margin:auto}.sp-c-bxeRRt{-webkit-appearance:none;appearance:none;outline:none;display:flex;align-items:center;font-size:inherit;font-family:inherit;background-color:transparent;transition:color var(--sp-transitions-default), background var(--sp-transitions-default);cursor:pointer;color:var(--sp-colors-clickable);border:0;text-decoration:none}.sp-c-bxeRRt:disabled{color:var(--sp-colors-disabled)}.sp-c-bxeRRt:hover:not(:disabled,[data-active='true']){color:var(--sp-colors-hover)}.sp-c-bxeRRt[data-active="true"]{color:var(--sp-colors-accent)}.sp-c-bxeRRt svg{min-width:var(--sp-space-4);width:var(--sp-space-4);height:var(--sp-space-4)}.sp-c-bxeRRt.sp-c-gMfcns{padding:var(--sp-space-1);height:var(--sp-space-7);display:flex}.sp-c-bxeRRt.sp-c-gMfcns.sp-c-bxeRRt:not(:has(span)){width:var(--sp-space-7)}.sp-c-bxeRRt.sp-c-gMfcns.sp-c-bxeRRt:has(svg + span){padding-right:var(--sp-space-3);padding-left:var(--sp-space-2);gap:var(--sp-space-1)}.sp-c-hfoyCM{padding:0 var(--sp-space-1) 0 var(--sp-space-1);border-radius:var(--sp-border-radius);margin-left:var(--sp-space-1);width:var(--sp-space-5);visibility:hidden}.sp-c-hfoyCM svg{width:var(--sp-space-3);height:var(--sp-space-3);display:block;position:relative;top:1px}.sp-c-fWymNx{margin:0;display:block;font-family:var(--sp-font-mono);font-size:var(--sp-font-size);color:var(--sp-syntax-color-plain);line-height:var(--sp-font-lineHeight)}.sp-c-euXojQ{display:flex;flex-direction:column;width:100%;position:relative;background-color:var(--sp-colors-surface1);gap:1px}.sp-c-euXojQ:has(.sp-stack){background-color:var(--sp-colors-surface2)}.sp-c-bpmgvy{transform:translate(-4px, 9px) scale(0.13, 0.13)}.sp-c-bpmgvy *{position:absolute;width:96px;height:96px}.sp-c-fVPbOs{all:initial;font-size:var(--sp-font-size);font-family:var(--sp-font-body);display:block;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-tap-highlight-color:transparent;-webkit-font-smoothing:subpixel-antialiased}@media screen and (min-resolution: 2dppx){.sp-c-fVPbOs{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}}.sp-c-fVPbOs *{box-sizing:border-box}.sp-c-fVPbOs .sp-wrapper:focus{outline:0}.sp-c-ikJbEZ{border:1px solid var(--sp-colors-surface2);display:flex;flex-wrap:wrap;align-items:stretch;border-radius:var(--sp-border-radius);overflow:hidden;position:relative;background-color:var(--sp-colors-surface2);gap:1px}.sp-c-ikJbEZ > .sp-c-euXojQ{flex-grow:1;flex-shrink:1;flex-basis:0;height:var(--sp-layout-height);overflow:hidden}@media print{.sp-c-ikJbEZ > .sp-c-euXojQ{height:auto;display:block}}@media screen and (max-width: 768px){.sp-c-ikJbEZ > .sp-c-euXojQ:not(.sp-preview, .sp-editor, .sp-preset-column){height:calc(var(--sp-layout-height) / 2)}}@media screen and (max-width: 768px){.sp-c-ikJbEZ > .sp-c-euXojQ{min-width:100%;}}.sp-c-ikJbEZ > .sp-file-explorer{flex:0.2;min-width:200px}@media screen and (max-width: 768px){.sp-c-ikJbEZ > .sp-file-explorer{flex:1}}.sp-c-gtcpyq{flex:1;position:relative;overflow:auto;background:var(--sp-colors-surface1)}.sp-c-gtcpyq .cm-scroller{padding:var(--sp-space-4) 0}.sp-c-gtcpyq .sp-c-fWymNx{padding:var(--sp-space-4) 0}@media screen and (max-width: 768px){@supports (-webkit-overflow-scrolling: touch){.sp-c-gtcpyq .cm-content{font-size:16px}}}.sp-c-jOWzsE{margin:0;outline:none;height:100%}.sp-c-jkvvao .sp-syntax-string{color:var(--sp-syntax-color-string);font-style:var(--sp-syntax-fontStyle-string)}.sp-c-jkvvao .sp-syntax-plain{color:var(--sp-syntax-color-plain);font-style:var(--sp-syntax-fontStyle-plain)}.sp-c-jkvvao .sp-syntax-comment{color:var(--sp-syntax-color-comment);font-style:var(--sp-syntax-fontStyle-comment)}.sp-c-jkvvao .sp-syntax-keyword{color:var(--sp-syntax-color-keyword);font-style:var(--sp-syntax-fontStyle-keyword)}.sp-c-jkvvao .sp-syntax-definition{color:var(--sp-syntax-color-definition);font-style:var(--sp-syntax-fontStyle-definition)}.sp-c-jkvvao .sp-syntax-punctuation{color:var(--sp-syntax-color-punctuation);font-style:var(--sp-syntax-fontStyle-punctuation)}.sp-c-jkvvao .sp-syntax-property{color:var(--sp-syntax-color-property);font-style:var(--sp-syntax-fontStyle-property)}.sp-c-jkvvao .sp-syntax-tag{color:var(--sp-syntax-color-tag);font-style:var(--sp-syntax-fontStyle-tag)}.sp-c-jkvvao .sp-syntax-static{color:var(--sp-syntax-color-static);font-style:var(--sp-syntax-fontStyle-static)}.sp-c-juMdfR{flex:1;display:flex;flex-direction:column;background:white;overflow:auto;position:relative}.sp-c-juMdfR .sp-bridge-frame{border:0;position:absolute;left:var(--sp-space-2);bottom:var(--sp-space-2);z-index:var(--sp-zIndices-top);height:12px;width:30%;mix-blend-mode:multiply;pointer-events:none}.sp-c-fgviib{border:0;outline:0;width:100%;height:100%;min-height:160px;max-height:2000px;flex:1}.sp-c-kwibBT{display:flex;position:absolute;bottom:var(--sp-space-2);right:var(--sp-space-2);z-index:var(--sp-zIndices-overlay);gap:var(--sp-space-2)}.sp-c-dEbKhQ{background-color:var(--sp-colors-surface2);border-radius:99999px;border:1px solid var(--sp-colors-surface3)}.sp-c-dEbKhQ[data-active="true"]{color:var(--sp-colors-surface1);background:var(--sp-colors-accent)}.sp-c-dEbKhQ:hover:not(:disabled,[data-active='true']){background-color:var(--sp-colors-surface3)}}--sxs{--sxs:3 sp-c-PJLV-kCOVwI-status-pass sp-c-PJLV-kEzYsr-status-fail sp-c-PJLV-gHAhSA-status-skip sp-c-PJLV-jgnHyR-status-title sp-c-PJLV-iCgxLS-status-run sp-c-PJLV-bnDZSy-status-pass sp-c-PJLV-eYuGwt-status-fail sp-c-fVPbOs-LrWkf-variant-dark}@media{.sp-c-PJLV-kCOVwI-status-pass{color:var(--test-pass)}.sp-c-PJLV-kEzYsr-status-fail{color:var(--test-fail)}.sp-c-PJLV-gHAhSA-status-skip{color:var(--test-skip)}.sp-c-PJLV-jgnHyR-status-title{color:var(--test-title)}.sp-c-PJLV-iCgxLS-status-run{background:var(--test-run);color:var(--sp-colors-surface1)}.sp-c-PJLV-bnDZSy-status-pass{background:var(--test-pass);color:var(--sp-colors-surface1)}.sp-c-PJLV-eYuGwt-status-fail{background:var(--test-fail);color:var(--sp-colors-surface1)}.sp-c-fVPbOs-LrWkf-variant-dark{color-scheme:dark}}</style></head><body><nav class="styles_container__iTIYP"><a class="styles_item__TNvI5 styles_back__bRzHW" aria-label="Posts" href="/"><svg role="img" class="styles_icon__kjLYW" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></a><div class="styles_spacer__a_oMO"></div><a class="styles_item__TNvI5" href="/rss.xml"><svg class="styles_icon__kjLYW" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a><button type="button" title="Toggle theme" class="styles_button__wGUhj styles_item__TNvI5"><span class="styles_icons__92_2E"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="styles_sun__rTG7N"><path fill="currentColor" d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="styles_moon__HPv9o"><path fill="currentColor" d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z"></path></svg></span></button></nav><main><article><h1>How to write a minimal code editor</h1><div class="styles_meta__208KK"><span>5 min read</span><time dateTime="2023-11-16">November 16, 2023</time></div><p>Code editors are complex. They do a lot of things to emulate the same experience as normal <code>textarea</code> while providing a ton of additional features such as indenting the code, autocomplete, annotations, multiple cursors etc. In this article, we&#x27;ll do none of these things.</p>
<p>Well, that&#x27;s disappointing. I hear you say. Wait, don&#x27;t close the page. I still have something for you.</p>
<p>Sometimes, all you want is a basic editor to embed some editable code on a page. You don&#x27;t need all the features of the complex editors. All you care about is that it should be lightweight and should load fast. We&#x27;ll discuss an approach to achieve just that.</p>
<h2 id="how-do-code-editors-work"><a href="#how-do-code-editors-work">How do code editors work?</a></h2>
<p>Typically, code editors such as <a href="https://codemirror.net" rel="nofollow" target="_blank">CodeMirror</a>, <a href="https://ace.c9.io/" rel="nofollow" target="_blank">Ace</a>, <a href="https://microsoft.github.io/monaco-editor" rel="nofollow" target="_blank">Monaco</a> etc. use a hidden <code>textarea</code> to detect what you type and other operations. Then they reflect those changes in the DOM so it appears like you&#x27;re directly editing it. The caret you see is fake and is just a <code>div</code> pretending to be a caret. There is usually a lot more going on, and some editors may take a different approach. But that&#x27;s the gist of it.</p>
<p>Another approach is to use <code>contentEditable</code> div which allows you to make any element editable. <a href="https://github.com/FormidableLabs/react-live" rel="nofollow" target="_blank"><code>react-live</code></a> uses this approach. But <code>contentEditable</code> can often be tricky to work with.</p>
<p>But we are here to build a minimal code editor, so we&#x27;ll take a different route that&#x27;s easier to implement.</p>
<h2 id="using-a-hidden-textarea"><a href="#using-a-hidden-textarea">Using a hidden <code>textarea</code></a></h2>
<p>While we&#x27;re not going to follow the same approach as other editors, a hidden <code>textarea</code> is still going to be a part of our solution.</p>
<p>The idea is that we use a normal <code>textarea</code> for our editor, highlight the code with <a href="https://prismjs.com" rel="nofollow" target="_blank">prismjs</a> and align it on top of the <code>textarea</code>. Whenever the <code>textarea</code>&#x27;s value changes, we update the highlighted code. Then we disable interactions with the highlighted code by using <code>pointer-events: none</code> and whenever you interact with the editor, you actually interact with the <code>textarea</code>.</p>
<p>I got this idea from a library (<a href="https://github.com/kueblc/LDT" rel="nofollow" target="_blank">kueblc/LDT</a>) around 5 years ago.</p>
<p>Here is a demo editor with this approach:</p>
<div class="sp-2099534210 sp-c-fVPbOs sp-c-fVPbOs-LrWkf-variant-dark sp-wrapper"><div class="sp-c-ikJbEZ styles_container__HbJzg sp-layout" style="--editor-height:500px;--preview-height:var(--sp-layout-height)"><div class="sp-c-euXojQ styles_pane__66_wF styles_editor__rBVsW sp-editor sp-stack"><div class="sp-c-gtcpyq sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript sp-c-jOWzsE sp-c-jkvvao sp-cm" role="textbox" tabindex="0" translate="no"><pre class="sp-c-fWymNx sp-pre-placeholder" style="margin-left:var(--sp-space-5)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-keyword">*</span> <span class="sp-syntax-keyword">as</span> <span class="sp-syntax-plain">React</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">highlight</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">languages</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;prismjs/components/prism-core&#x27;</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-keyword">import</span> <span class="sp-syntax-string">&#x27;prismjs/components/prism-clike&#x27;</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-keyword">import</span> <span class="sp-syntax-string">&#x27;prismjs/components/prism-javascript&#x27;</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-keyword">import</span> <span class="sp-syntax-string">&#x27;prismjs/themes/prism.css&#x27;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">App</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">value</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setValue</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-plain">React</span>.<span class="sp-syntax-property">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">code</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">div</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">textarea</span> <span class="sp-syntax-property">value</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">value</span><span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-property">onChange</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">e</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-definition">setValue</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">e</span>.<span class="sp-syntax-property">target</span>.<span class="sp-syntax-property">value</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-punctuation">/&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">pre</span>
        <span class="sp-syntax-property">dangerouslySetInnerHTML</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">{</span>
          <span class="sp-syntax-property">__html</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-definition">highlight</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">value</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">languages</span>.<span class="sp-syntax-property">js</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-string">&#x27;js&#x27;</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">,</span>
        <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span>
      <span class="sp-syntax-punctuation">/&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">style</span><span class="sp-syntax-punctuation">&gt;</span><span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">css</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">style</span><span class="sp-syntax-punctuation">&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">div</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

<span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">code</span> = <span class="sp-syntax-string">`function add(a, b) {
  return a + b;
}
`</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">css</span> = <span class="sp-syntax-string">`
div {
  font-family: monospace;
  font-size: 18px;
  position: relative;
  text-align: left;
  overflow: hidden;
  padding: 0;
  height: 200px;
}

textarea, pre {
  box-sizing: inherit;
  display: inherit;
  font: inherit;
  letter-spacing: inherit;
  line-height: inherit;
  tab-size: inherit;
  text-indent: inherit;
  text-rendering: inherit;
  text-transform: inherit;
  margin: 0;
  padding: 0;
  border: 0;
  white-space: pre-wrap;
}

textarea {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  outline: 0;
  resize: none;
  background: none;
  overflow: hidden;

  -moz-font-smoothing: antialiased;
  -webkit-font-smoothing: antialiased;
  -webkit-text-fill-color: transparent;
}

pre {
  position: relative;
  pointer-events: none;
}
`</span><span class="sp-syntax-punctuation">;</span>

</pre></div></div></div><div class="sp-c-euXojQ styles_pane__66_wF styles_preview__aj2g6 sp-preview sp-stack"><div class="sp-c-juMdfR sp-preview-container"><iframe class="sp-c-fgviib sp-preview-iframe" title="Sandpack Preview"></iframe><div class="sp-c-kwibBT sp-preview-actions"><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="sp-icon-standalone sp-c-bxeRRt sp-c-gMfcns sp-c-dEbKhQ sp-button"><svg fill="none" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg" stroke="currentColor"><title>Open on CodeSandbox</title><path d="M6.66665 3.33337H4.33331C3.78103 3.33337 3.33331 3.78109 3.33331 4.33337V11.6667C3.33331 12.219 3.78103 12.6667 4.33331 12.6667H11.6666C12.2189 12.6667 12.6666 12.219 12.6666 11.6667V9.33337" stroke-linecap="round"></path><path d="M10 3.33337H12.5667C12.6219 3.33337 12.6667 3.37815 12.6667 3.43337V6.00004" stroke-linecap="round"></path><path d="M7.33331 8.66668L12.5333 3.46667" stroke-linecap="round"></path></svg><span>Open Sandbox</span></a></div></div></div></div></div>
<p>We are doing the following things here:</p>
<ul>
<li>We use a <code>textarea</code> with the code and a <code>pre</code> element to display the highlighted code.</li>
<li>The text is kept in sync by updating the <code>pre</code> element whenever the <code>textarea</code>&#x27;s value changes.</li>
<li>The <code>pre</code> has <code>pointer-events: none</code> so that you can&#x27;t interact with it.</li>
<li>Additional styles are applied to make the <code>textarea</code> and <code>pre</code> look the same with same font, line height etc.</li>
<li>The text in the <code>textarea</code> is hidden by <code>-webkit-text-fill-color: transparent</code> (it also works on non-webkit browsers such as Firefox).</li>
<li>The syntax highlighting is done by <a href="https://prismjs.com" rel="nofollow" target="_blank">prismjs</a>.</li>
</ul>
<p>So now we have a minimal code editor which is super lightweight and good enough for simple use cases.</p>
<h2 id="whats-missing"><a href="#whats-missing">What&#x27;s missing?</a></h2>
<p>A good code editor is not only text with syntax highlighting. There are still a few more things we need to do to make it usable.</p>
<h3 id="indentation"><a href="#indentation">Indentation</a></h3>
<p>A large part of writing code is indenting it, and a simple text area doesn&#x27;t provide this feature.</p>
<p>To implement indentation support with tab, we will need to listen to <code>keydown</code> events from the <code>textarea</code> and check if tab key was pressed. Then we can prevent the default behaviour and insert the tab character programmatically.</p>
<p>To handle tabs properly (inserting tab character, indenting and unindenting a selected text while maintaining proper selection etc.), a fair bit of code is required, so I&#x27;m not going to discuss it here.</p>
<h3 id="undoredo"><a href="#undoredo">Undo/redo</a></h3>
<p>When updating the <code>textarea</code> programmatically, the undo stack gets lost. We can use <code>document.execCommand</code> instead to insert the text, which will preserve the undo stack. However, it&#x27;s a deprecated feature and also doesn&#x27;t work on Firefox (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1220696%5B%5D" rel="nofollow" target="_blank">bug 1220696</a>), so it&#x27;s not a feasible solution.</p>
<p>The only option I know at the time of writing this post is to implement a custom undo manager and maintain our own undo stack. Then we can listen to <code>keydown</code> events for undo/redo shortcuts, and apply the changes ourselves instead of relying on the browser.</p>
<h3 id="switching-focus"><a href="#switching-focus">Switching focus</a></h3>
<p>Since we are intercepting tab key, the default behaviour of switching focus is now gone, which is not good for accessibility. The best we can do here is to provide a keybinding which allows toggling this behaviour.</p>
<h2 id="limitations"><a href="#limitations">Limitations</a></h2>
<p>There are limitations of this approach to be aware of:</p>
<ul>
<li>The syntax highlighted code cannot have different font family, font weight, font style, line height etc. for its content. Since the editor works by aligning the highlighted code over a <code>textarea</code>, changing anything that affects the layout can misalign it.</li>
<li>The custom undo stack is incompatible with undo/redo items browser&#x27;s context menu.</li>
<li>Since the editor works by syntax highlighting the all of the code and inserting it DOM, unlike other editors which tokenize and highlight only parts of the code, the editor is not optimized for performance and large documents can inversely affect the typing speed.</li>
</ul>
<p>Because of these limitations, this approach is not suitable for full featured code editors. But it&#x27;s good enough for basic use cases.</p>
<h2 id="wrapping-up"><a href="#wrapping-up">Wrapping up</a></h2>
<p>A while ago I made this idea into a package: <a href="https://github.com/react-simple-code-editor/react-simple-code-editor" rel="nofollow" target="_blank"><code>react-simple-code-editor</code></a>. It implements the indentation, undo/redo and focus switching features discussed above. The syntax highlighting can be done by any third party library (such as Prism). You can try the <a href="https://react-simple-code-editor.github.io/react-simple-code-editor" rel="nofollow" target="_blank">demo here</a>.</p>
<p>This component is used in <a href="https://snack.expo.dev" rel="nofollow" target="_blank">snack.expo.dev</a> to provide a minimal code editor for embedding code snippets, as well as a replacement for the default editor on slower connections.</p></article><ul class="styles_social__ZeynR"><li><a href="https://x.com/intent/tweet?text=satya164&#x27;s%20blog&amp;url=https%3A%2F%2Fsatya164.page%2Fposts%2Fhow-to-write-a-minimal-code-editor&amp;via=satya164" target="_blank" rel="noopener noreferrer">Share on X</a></li><li><a href="https://twitter.com/search?q=https%3A%2F%2Fsatya164.page%2Fposts%2Fhow-to-write-a-minimal-code-editor" target="_blank" rel="noopener noreferrer">Discuss on X</a></li></ul></main><footer>Copyright © 2023 <a href="/about">Satyajit Sahoo</a>. All rights reserved.</footer><script src="/_next/static/chunks/webpack-0f1fd53fa6282c30.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/4de1fea1a954a5b6-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/6d664cce900333ee-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/media/cb0a9ee3a59e8bf7-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n4:HL[\"/_next/static/media/df99695897be762b-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n5:HL[\"/_next/static/css/e2fbf83149064d67.css\",\"style\"]\n6:HL[\"/_next/static/css/54406936ac53aaa7.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"7:I[5751,[],\"\"]\na:I[9275,[],\"\"]\nc:I[1343,[],\"\"]\nd:I[7786,[\"401\",\"static/chunks/363642f4-9e72429e661e47fa.js\",\"344\",\"static/chunks/e58a7f8f-3e17ebe2d129a781.js\",\"173\",\"static/chunks/173-26eb077acb4f64fe.js\",\"459\",\"static/chunks/459-ba55fbbe75738db5.js\",\"231\",\"static/chunks/231-c1c00e13a9884adf.js\",\"185\",\"static/chunks/app/layout-248d866a3f57725c.js\"],\"script\"]\ne:I[9645,[\"401\",\"static/chunks/363642f4-9e72429e661e47fa.js\",\"344\",\"static/chunks/e58a7f8f-3e17ebe2d129a781.js\",\"173\",\"static/chunks/173-26eb077acb4f64fe.js\",\"459\",\"static/chunks/459-ba55fbbe75738db5.js\",\"231\",\"static/chunks/231-c1c00e13a9884adf.js\",\"185\",\"static/chunks/app/layout-248d866a3f57725c.js\"],\"default\"]\nf:I[98,[\"401\",\"static/chunks/363642f4-9e72429e661e47fa.js\",\"344\",\"static/chunks/e58a7f8f-3e17ebe2d129a781.js\",\"173\",\"static/chunks/173-26eb077acb4f64fe.js\",\"459\",\"static/chunks/459-ba55fbbe75738db5.js\",\"231\",\"static/chunks/231-c1c00e13a9884adf.js\",\"185\",\"static/chunks/app/layout-248d866a3f57725c.js\"],\"NavBar\"]\n10:I[231,[\"401\",\"static/chunks/363642f4-9e72429e661e47fa.js\",\"344\",\"static/chunks/e58a7f8f-3e17ebe2d129a781.js\",\"173\",\"static/chunks/173-26eb077acb4f64fe.js\",\"459\",\"static/chunks/459-ba55fbbe75738db5.js\",\"231\",\"static/chunks/231-c1c00e13a9884adf.js\",\"931\",\"static/chunks/app/page-91bc2a8110eb7406.js\"],\"\"]\n12:I[6130,[],\"\"]\nb:[\"id\",\"how-to-write-a-minimal-code-editor\",\"d\"]\n13:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/e2fbf83149064d67.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L7\",null,{\"buildId\":\"Khf7Ll6Gbygbd5Fp_tzyv\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/how-to-write-a-minimal-code-editor\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"how-to-write-a-minimal-code-editor\",\"d\"],{\"children\":[\"__PAGE__?{\\\"id\\\":\\\"how-to-write-a-minimal-code-editor\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"how-to-write-a-minimal-code-editor\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L8\",\"$L9\"],null],null]},[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",\"$b\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/54406936ac53aaa7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}],null]},[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__variable_7c3f16 __variable_6c6f2f __variable_988d07\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$d\"}}],[\"$\",\"$Le\",null,{}]]}],[\"$\",\"body\",null,{\"children\":[[\"$\",\"$Lf\",null,{}],[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}],[\"$\",\"footer\",null,{\"children\":[\"Copyright © 2023 \",[\"$\",\"$L10\",null,{\"href\":\"/about\",\"children\":\"Satyajit Sahoo\"}],\". All rights reserved.\"]}]]}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L11\"],\"globalErrorComponent\":\"$12\",\"missingSlots\":\"$W13\"}]]\n"])</script><script>self.__next_f.push([1,"14:I[9936,[\"401\",\"static/chunks/363642f4-9e72429e661e47fa.js\",\"344\",\"static/chunks/e58a7f8f-3e17ebe2d129a781.js\",\"173\",\"static/chunks/173-26eb077acb4f64fe.js\",\"459\",\"static/chunks/459-ba55fbbe75738db5.js\",\"722\",\"static/chunks/app/posts/%5Bid%5D/page-540fdedccf18a6b4.js\"],\"Pre\"]\n16:I[420,[\"401\",\"static/chunks/363642f4-9e72429e661e47fa.js\",\"344\",\"static/chunks/e58a7f8f-3e17ebe2d129a781.js\",\"173\",\"static/chunks/173-26eb077acb4f64fe.js\",\"459\",\"static/chunks/459-ba55fbbe75738db5.js\",\"722\",\"static/chunks/app/posts/%5Bid%5D/page-540fdedccf18a6b4.js\"],\"SocialLinks\"]\n15:T588,import * as React from 'react';\nimport { highlight, languages } from 'prismjs/components/prism-core';\nimport 'prismjs/components/prism-clike';\nimport 'prismjs/components/prism-javascript';\nimport 'prismjs/themes/prism.css';\n\nexport default function App() {\n  const [value, setValue] = React.useState(code);\n\n  return (\n    \u003cdiv\u003e\n      \u003ctextarea value={value} onChange={(e) =\u003e setValue(e.target.value)} /\u003e\n      \u003cpre\n        dangerouslySetInnerHTML={{\n          __html: highlight(value, languages.js, 'js'),\n        }}\n      /\u003e\n      \u003cstyle\u003e{css}\u003c/style\u003e\n    \u003c/div\u003e\n  );\n}\n\nconst code = `function add(a, b) {\n  return a + b;\n}\n`;\n\nconst css = `\ndiv {\n  font-family: monospace;\n  font-size: 18px;\n  position: relative;\n  text-align: left;\n  overflow: hidden;\n  padding: 0;\n  height: 200px;\n}\n\ntextarea, pre {\n  box-sizing: inherit;\n  display: inherit;\n  font: inherit;\n  letter-spacing: inherit;\n  line-height: inherit;\n  tab-size: inherit;\n  text-indent: inherit;\n  text-rendering: inherit;\n  text-transform: inherit;\n  margin: 0;\n  padding: 0;\n  border: 0;\n  white-space: pre-wrap;\n}\n\ntextarea {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n  outline: 0;\n  resize: none;\n  background: none;\n  overflow: hidden;\n\n  -moz-font-smoothing: antialiased;\n  -webkit-font-smoothing: antialiased;\n  -webkit-text-fill-color: transparent;\n}\n\npre {\n  position: relative;\n  pointer-events: none;\n}\n`;\n"])</script><script>self.__next_f.push([1,"9:[\"$\",\"main\",null,{\"children\":[[\"$\",\"article\",null,{\"children\":[[\"$\",\"h1\",null,{\"children\":\"How to write a minimal code editor\"}],[\"$\",\"div\",null,{\"className\":\"styles_meta__208KK\",\"children\":[[\"$\",\"span\",null,{\"children\":\"5 min read\"}],[\"$\",\"time\",null,{\"dateTime\":\"2023-11-16\",\"children\":\"November 16, 2023\"}]]}],[[\"$\",\"p\",null,{\"children\":[\"Code editors are complex. They do a lot of things to emulate the same experience as normal \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\" while providing a ton of additional features such as indenting the code, autocomplete, annotations, multiple cursors etc. In this article, we'll do none of these things.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Well, that's disappointing. I hear you say. Wait, don't close the page. I still have something for you.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Sometimes, all you want is a basic editor to embed some editable code on a page. You don't need all the features of the complex editors. All you care about is that it should be lightweight and should load fast. We'll discuss an approach to achieve just that.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"how-do-code-editors-work\",\"children\":[\"$\",\"a\",null,{\"href\":\"#how-do-code-editors-work\",\"children\":\"How do code editors work?\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Typically, code editors such as \",[\"$\",\"a\",null,{\"href\":\"https://codemirror.net\",\"rel\":\"nofollow\",\"target\":\"_blank\",\"children\":\"CodeMirror\"}],\", \",[\"$\",\"a\",null,{\"href\":\"https://ace.c9.io/\",\"rel\":\"nofollow\",\"target\":\"_blank\",\"children\":\"Ace\"}],\", \",[\"$\",\"a\",null,{\"href\":\"https://microsoft.github.io/monaco-editor\",\"rel\":\"nofollow\",\"target\":\"_blank\",\"children\":\"Monaco\"}],\" etc. use a hidden \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\" to detect what you type and other operations. Then they reflect those changes in the DOM so it appears like you're directly editing it. The caret you see is fake and is just a \",[\"$\",\"code\",null,{\"children\":\"div\"}],\" pretending to be a caret. There is usually a lot more going on, and some editors may take a different approach. But that's the gist of it.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Another approach is to use \",[\"$\",\"code\",null,{\"children\":\"contentEditable\"}],\" div which allows you to make any element editable. \",[\"$\",\"a\",null,{\"href\":\"https://github.com/FormidableLabs/react-live\",\"rel\":\"nofollow\",\"target\":\"_blank\",\"children\":[\"$\",\"code\",null,{\"children\":\"react-live\"}]}],\" uses this approach. But \",[\"$\",\"code\",null,{\"children\":\"contentEditable\"}],\" can often be tricky to work with.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"But we are here to build a minimal code editor, so we'll take a different route that's easier to implement.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"using-a-hidden-textarea\",\"children\":[\"$\",\"a\",null,{\"href\":\"#using-a-hidden-textarea\",\"children\":[\"Using a hidden \",[\"$\",\"code\",null,{\"children\":\"textarea\"}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"While we're not going to follow the same approach as other editors, a hidden \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\" is still going to be a part of our solution.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The idea is that we use a normal \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\" for our editor, highlight the code with \",[\"$\",\"a\",null,{\"href\":\"https://prismjs.com\",\"rel\":\"nofollow\",\"target\":\"_blank\",\"children\":\"prismjs\"}],\" and align it on top of the \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\". Whenever the \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\"'s value changes, we update the highlighted code. Then we disable interactions with the highlighted code by using \",[\"$\",\"code\",null,{\"children\":\"pointer-events: none\"}],\" and whenever you interact with the editor, you actually interact with the \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"I got this idea from a library (\",[\"$\",\"a\",null,{\"href\":\"https://github.com/kueblc/LDT\",\"rel\":\"nofollow\",\"target\":\"_blank\",\"children\":\"kueblc/LDT\"}],\") around 5 years ago.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Here is a demo editor with this approach:\"}],\"\\n\",[\"$\",\"$L14\",null,{\"data-playground\":\"react\",\"data-dependencies\":\"prismjs@1.29.0\",\"data-editor-height\":\"500px\",\"children\":\"$15\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We are doing the following things here:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"We use a \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\" with the code and a \",[\"$\",\"code\",null,{\"children\":\"pre\"}],\" element to display the highlighted code.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"The text is kept in sync by updating the \",[\"$\",\"code\",null,{\"children\":\"pre\"}],\" element whenever the \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\"'s value changes.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"pre\"}],\" has \",[\"$\",\"code\",null,{\"children\":\"pointer-events: none\"}],\" so that you can't interact with it.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Additional styles are applied to make the \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"pre\"}],\" look the same with same font, line height etc.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"The text in the \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\" is hidden by \",[\"$\",\"code\",null,{\"children\":\"-webkit-text-fill-color: transparent\"}],\" (it also works on non-webkit browsers such as Firefox).\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"The syntax highlighting is done by \",[\"$\",\"a\",null,{\"href\":\"https://prismjs.com\",\"rel\":\"nofollow\",\"target\":\"_blank\",\"children\":\"prismjs\"}],\".\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"So now we have a minimal code editor which is super lightweight and good enough for simple use cases.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"whats-missing\",\"children\":[\"$\",\"a\",null,{\"href\":\"#whats-missing\",\"children\":\"What's missing?\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"A good code editor is not only text with syntax highlighting. There are still a few more things we need to do to make it usable.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"indentation\",\"children\":[\"$\",\"a\",null,{\"href\":\"#indentation\",\"children\":\"Indentation\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"A large part of writing code is indenting it, and a simple text area doesn't provide this feature.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"To implement indentation support with tab, we will need to listen to \",[\"$\",\"code\",null,{\"children\":\"keydown\"}],\" events from the \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\" and check if tab key was pressed. Then we can prevent the default behaviour and insert the tab character programmatically.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"To handle tabs properly (inserting tab character, indenting and unindenting a selected text while maintaining proper selection etc.), a fair bit of code is required, so I'm not going to discuss it here.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"undoredo\",\"children\":[\"$\",\"a\",null,{\"href\":\"#undoredo\",\"children\":\"Undo/redo\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When updating the \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\" programmatically, the undo stack gets lost. We can use \",[\"$\",\"code\",null,{\"children\":\"document.execCommand\"}],\" instead to insert the text, which will preserve the undo stack. However, it's a deprecated feature and also doesn't work on Firefox (\",[\"$\",\"a\",null,{\"href\":\"https://bugzilla.mozilla.org/show_bug.cgi?id=1220696%5B%5D\",\"rel\":\"nofollow\",\"target\":\"_blank\",\"children\":\"bug 1220696\"}],\"), so it's not a feasible solution.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The only option I know at the time of writing this post is to implement a custom undo manager and maintain our own undo stack. Then we can listen to \",[\"$\",\"code\",null,{\"children\":\"keydown\"}],\" events for undo/redo shortcuts, and apply the changes ourselves instead of relying on the browser.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"switching-focus\",\"children\":[\"$\",\"a\",null,{\"href\":\"#switching-focus\",\"children\":\"Switching focus\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Since we are intercepting tab key, the default behaviour of switching focus is now gone, which is not good for accessibility. The best we can do here is to provide a keybinding which allows toggling this behaviour.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"limitations\",\"children\":[\"$\",\"a\",null,{\"href\":\"#limitations\",\"children\":\"Limitations\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"There are limitations of this approach to be aware of:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"The syntax highlighted code cannot have different font family, font weight, font style, line height etc. for its content. Since the editor works by aligning the highlighted code over a \",[\"$\",\"code\",null,{\"children\":\"textarea\"}],\", changing anything that affects the layout can misalign it.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"The custom undo stack is incompatible with undo/redo items browser's context menu.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Since the editor works by syntax highlighting the all of the code and inserting it DOM, unlike other editors which tokenize and highlight only parts of the code, the editor is not optimized for performance and large documents can inversely affect the typing speed.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Because of these limitations, this approach is not suitable for full featured code editors. But it's good enough for basic use cases.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"wrapping-up\",\"children\":[\"$\",\"a\",null,{\"href\":\"#wrapping-up\",\"children\":\"Wrapping up\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"A while ago I made this idea into a package: \",[\"$\",\"a\",null,{\"href\":\"https://github.com/react-simple-code-editor/react-simple-code-editor\",\"rel\":\"nofollow\",\"target\":\"_blank\",\"children\":[\"$\",\"code\",null,{\"children\":\"react-simple-code-editor\"}]}],\". It implements the indentation, undo/redo and focus switching features discussed above. The syntax highlighting can be done by any third party library (such as Prism). You can try the \",[\"$\",\"a\",null,{\"href\":\"https://react-simple-code-editor.github.io/react-simple-code-editor\",\"rel\":\"nofollow\",\"target\":\"_blank\",\"children\":\"demo here\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This component is used in \",[\"$\",\"a\",null,{\"href\":\"https://snack.expo.dev\",\"rel\":\"nofollow\",\"target\":\"_blank\",\"children\":\"snack.expo.dev\"}],\" to provide a minimal code editor for embedding code snippets, as well as a replacement for the default editor on slower connections.\"]}]]]}],[\"$\",\"$L16\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"11:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"How to write a minimal code editor · satya164's blog\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Writing a code editor is a complex task. But what if there was an alternative approach for simpler use cases?\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"How to write a minimal code editor\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"Writing a code editor is a complex task. But what if there was an alternative approach for simpler use cases?\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"7\",{\"property\":\"article:published_time\",\"content\":\"2023-11-16T00:00:00.000Z\"}],[\"$\",\"meta\",\"8\",{\"property\":\"article:author\",\"content\":\"Satyajit Sahoo\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:creator\",\"content\":\"@satya164\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:title\",\"content\":\"How to write a minimal code editor\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:description\",\"content\":\"Writing a code editor is a complex task. But what if there was an alternative approach for simpler use cases?\"}],[\"$\",\"link\",\"13\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}],[\"$\",\"meta\",\"14\",{\"name\":\"next-size-adjust\"}]]\n8:null\n"])</script></body></html><style id="sandpack">--sxs{--sxs:0 sp-2099534210}@media{.sp-2099534210{--sp-space-1:4px;--sp-space-2:8px;--sp-space-3:12px;--sp-space-4:16px;--sp-space-5:20px;--sp-space-6:24px;--sp-space-7:28px;--sp-space-8:32px;--sp-space-9:36px;--sp-space-10:40px;--sp-space-11:44px;--sp-border-radius:4px;--sp-layout-height:300px;--sp-layout-headerHeight:40px;--sp-transitions-default:150ms ease;--sp-zIndices-base:1;--sp-zIndices-overlay:2;--sp-zIndices-top:3;--sp-colors-surface1:#292d3e;--sp-colors-surface2:#35384a;--sp-colors-surface3:#404251;--sp-colors-disabled:#858591;--sp-colors-base:#ffffff;--sp-colors-clickable:#acafc3;--sp-colors-hover:#ffffff;--sp-colors-accent:#db537d;--sp-colors-error:#ffffff;--sp-colors-errorSurface:#3b3b4f;--sp-colors-warning:#E7C400;--sp-colors-warningSurface:#3A3000;--sp-font-body:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";--sp-font-mono:"Fira Code", "Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace;--sp-font-size:12px;--sp-font-lineHeight:18px;--sp-syntax-color-plain:#babed8;--sp-syntax-color-comment:#676e95;--sp-syntax-color-keyword:#89ddff;--sp-syntax-color-tag:#f07178;--sp-syntax-color-punctuation:#89ddff;--sp-syntax-color-definition:#82aaff;--sp-syntax-color-property:#ffcb6b;--sp-syntax-color-static:#f07178;--sp-syntax-color-string:#c3e88d}}--sxs{--sxs:1 sp-k-eyOShd sp-k-iOHdLQ}@media{@keyframes sp-k-eyOShd{0%{opacity:0}100%{opacity:1}}@keyframes sp-k-iOHdLQ{0%{transform:rotateX(-25.5deg) rotateY(45deg)}100%{transform:rotateX(-25.5deg) rotateY(405deg)}}}--sxs{--sxs:2 sp-c-gMfcns sp-c-bxeRRt sp-c-hfoyCM sp-c-fWymNx sp-c-euXojQ sp-c-bpmgvy sp-c-PJLV sp-c-fVPbOs sp-c-ikJbEZ sp-c-gtcpyq sp-c-jOWzsE sp-c-jkvvao sp-c-juMdfR sp-c-fgviib sp-c-kwibBT sp-c-dEbKhQ}@media{.sp-c-gMfcns svg{margin:auto}.sp-c-bxeRRt{-webkit-appearance:none;appearance:none;outline:none;display:flex;align-items:center;font-size:inherit;font-family:inherit;background-color:transparent;transition:color var(--sp-transitions-default), background var(--sp-transitions-default);cursor:pointer;color:var(--sp-colors-clickable);border:0;text-decoration:none}.sp-c-bxeRRt:disabled{color:var(--sp-colors-disabled)}.sp-c-bxeRRt:hover:not(:disabled,[data-active='true']){color:var(--sp-colors-hover)}.sp-c-bxeRRt[data-active="true"]{color:var(--sp-colors-accent)}.sp-c-bxeRRt svg{min-width:var(--sp-space-4);width:var(--sp-space-4);height:var(--sp-space-4)}.sp-c-bxeRRt.sp-c-gMfcns{padding:var(--sp-space-1);height:var(--sp-space-7);display:flex}.sp-c-bxeRRt.sp-c-gMfcns.sp-c-bxeRRt:not(:has(span)){width:var(--sp-space-7)}.sp-c-bxeRRt.sp-c-gMfcns.sp-c-bxeRRt:has(svg + span){padding-right:var(--sp-space-3);padding-left:var(--sp-space-2);gap:var(--sp-space-1)}.sp-c-hfoyCM{padding:0 var(--sp-space-1) 0 var(--sp-space-1);border-radius:var(--sp-border-radius);margin-left:var(--sp-space-1);width:var(--sp-space-5);visibility:hidden}.sp-c-hfoyCM svg{width:var(--sp-space-3);height:var(--sp-space-3);display:block;position:relative;top:1px}.sp-c-fWymNx{margin:0;display:block;font-family:var(--sp-font-mono);font-size:var(--sp-font-size);color:var(--sp-syntax-color-plain);line-height:var(--sp-font-lineHeight)}.sp-c-euXojQ{display:flex;flex-direction:column;width:100%;position:relative;background-color:var(--sp-colors-surface1);gap:1px}.sp-c-euXojQ:has(.sp-stack){background-color:var(--sp-colors-surface2)}.sp-c-bpmgvy{transform:translate(-4px, 9px) scale(0.13, 0.13)}.sp-c-bpmgvy *{position:absolute;width:96px;height:96px}.sp-c-fVPbOs{all:initial;font-size:var(--sp-font-size);font-family:var(--sp-font-body);display:block;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-tap-highlight-color:transparent;-webkit-font-smoothing:subpixel-antialiased}@media screen and (min-resolution: 2dppx){.sp-c-fVPbOs{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}}.sp-c-fVPbOs *{box-sizing:border-box}.sp-c-fVPbOs .sp-wrapper:focus{outline:0}.sp-c-ikJbEZ{border:1px solid var(--sp-colors-surface2);display:flex;flex-wrap:wrap;align-items:stretch;border-radius:var(--sp-border-radius);overflow:hidden;position:relative;background-color:var(--sp-colors-surface2);gap:1px}.sp-c-ikJbEZ > .sp-c-euXojQ{flex-grow:1;flex-shrink:1;flex-basis:0;height:var(--sp-layout-height);overflow:hidden}@media print{.sp-c-ikJbEZ > .sp-c-euXojQ{height:auto;display:block}}@media screen and (max-width: 768px){.sp-c-ikJbEZ > .sp-c-euXojQ:not(.sp-preview, .sp-editor, .sp-preset-column){height:calc(var(--sp-layout-height) / 2)}}@media screen and (max-width: 768px){.sp-c-ikJbEZ > .sp-c-euXojQ{min-width:100%;}}.sp-c-ikJbEZ > .sp-file-explorer{flex:0.2;min-width:200px}@media screen and (max-width: 768px){.sp-c-ikJbEZ > .sp-file-explorer{flex:1}}.sp-c-gtcpyq{flex:1;position:relative;overflow:auto;background:var(--sp-colors-surface1)}.sp-c-gtcpyq .cm-scroller{padding:var(--sp-space-4) 0}.sp-c-gtcpyq .sp-c-fWymNx{padding:var(--sp-space-4) 0}@media screen and (max-width: 768px){@supports (-webkit-overflow-scrolling: touch){.sp-c-gtcpyq .cm-content{font-size:16px}}}.sp-c-jOWzsE{margin:0;outline:none;height:100%}.sp-c-jkvvao .sp-syntax-string{color:var(--sp-syntax-color-string);font-style:var(--sp-syntax-fontStyle-string)}.sp-c-jkvvao .sp-syntax-plain{color:var(--sp-syntax-color-plain);font-style:var(--sp-syntax-fontStyle-plain)}.sp-c-jkvvao .sp-syntax-comment{color:var(--sp-syntax-color-comment);font-style:var(--sp-syntax-fontStyle-comment)}.sp-c-jkvvao .sp-syntax-keyword{color:var(--sp-syntax-color-keyword);font-style:var(--sp-syntax-fontStyle-keyword)}.sp-c-jkvvao .sp-syntax-definition{color:var(--sp-syntax-color-definition);font-style:var(--sp-syntax-fontStyle-definition)}.sp-c-jkvvao .sp-syntax-punctuation{color:var(--sp-syntax-color-punctuation);font-style:var(--sp-syntax-fontStyle-punctuation)}.sp-c-jkvvao .sp-syntax-property{color:var(--sp-syntax-color-property);font-style:var(--sp-syntax-fontStyle-property)}.sp-c-jkvvao .sp-syntax-tag{color:var(--sp-syntax-color-tag);font-style:var(--sp-syntax-fontStyle-tag)}.sp-c-jkvvao .sp-syntax-static{color:var(--sp-syntax-color-static);font-style:var(--sp-syntax-fontStyle-static)}.sp-c-juMdfR{flex:1;display:flex;flex-direction:column;background:white;overflow:auto;position:relative}.sp-c-juMdfR .sp-bridge-frame{border:0;position:absolute;left:var(--sp-space-2);bottom:var(--sp-space-2);z-index:var(--sp-zIndices-top);height:12px;width:30%;mix-blend-mode:multiply;pointer-events:none}.sp-c-fgviib{border:0;outline:0;width:100%;height:100%;min-height:160px;max-height:2000px;flex:1}.sp-c-kwibBT{display:flex;position:absolute;bottom:var(--sp-space-2);right:var(--sp-space-2);z-index:var(--sp-zIndices-overlay);gap:var(--sp-space-2)}.sp-c-dEbKhQ{background-color:var(--sp-colors-surface2);border-radius:99999px;border:1px solid var(--sp-colors-surface3)}.sp-c-dEbKhQ[data-active="true"]{color:var(--sp-colors-surface1);background:var(--sp-colors-accent)}.sp-c-dEbKhQ:hover:not(:disabled,[data-active='true']){background-color:var(--sp-colors-surface3)}}--sxs{--sxs:3 sp-c-PJLV-kCOVwI-status-pass sp-c-PJLV-kEzYsr-status-fail sp-c-PJLV-gHAhSA-status-skip sp-c-PJLV-jgnHyR-status-title sp-c-PJLV-iCgxLS-status-run sp-c-PJLV-bnDZSy-status-pass sp-c-PJLV-eYuGwt-status-fail sp-c-fVPbOs-LrWkf-variant-dark}@media{.sp-c-PJLV-kCOVwI-status-pass{color:var(--test-pass)}.sp-c-PJLV-kEzYsr-status-fail{color:var(--test-fail)}.sp-c-PJLV-gHAhSA-status-skip{color:var(--test-skip)}.sp-c-PJLV-jgnHyR-status-title{color:var(--test-title)}.sp-c-PJLV-iCgxLS-status-run{background:var(--test-run);color:var(--sp-colors-surface1)}.sp-c-PJLV-bnDZSy-status-pass{background:var(--test-pass);color:var(--sp-colors-surface1)}.sp-c-PJLV-eYuGwt-status-fail{background:var(--test-fail);color:var(--sp-colors-surface1)}.sp-c-fVPbOs-LrWkf-variant-dark{color-scheme:dark}}</style>
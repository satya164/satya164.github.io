<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"/><title>Automated Release on GitHub Actions</title><meta name="description" content="A guide to automatically release npm packages on GitHub Actions using release-it."/><meta name="keywords" content="Tooling"/><meta name="author" content="Satyajit Sahoo"/><meta name="next-head-count" content="7"/><link rel="preload" href="/_next/static/css/a0de50ea0cc40a66.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/a0de50ea0cc40a66.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-445a5fe7cadeec28.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-bbecb7d54330d002.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-6e8ee6ae7cc0a14c.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-87f129fb4847c111.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/61-8dd855f6011cdc95.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/512-a3ff5c471bab437b.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/posts/automated-release-on-github-actions-e67e406bce3c02af.js" defer="" crossorigin=""></script><script src="/_next/static/b3OQLwQgKfblSc4uNaOEV/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/b3OQLwQgKfblSc4uNaOEV/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><article class="nx-container nx-prose max-md:nx-prose-sm dark:nx-prose-dark" dir="ltr"><h1>Automated Release on GitHub Actions</h1><div class="nx-mb-8 nx-flex nx-gap-3 nx-items-center"><div class="nx-grow dark:nx-text-gray-400 nx-text-gray-600"><div class="nx-not-prose nx-flex nx-flex-wrap nx-items-center nx-gap-1">Satyajit Sahoo<!-- -->,<time dateTime="2023-11-02T00:00:00.000Z">Thu Nov 02 2023</time><span class="nx-px-1">•</span><a class="
          nx-select-none
          nx-rounded-md
          nx-bg-gray-200
          nx-px-1
          nx-text-sm
          nx-text-gray-400
          nx-transition-colors
          hover:nx-bg-gray-300
          hover:nx-text-gray-500
          dark:nx-bg-gray-600
          dark:nx-text-gray-300
          dark:hover:nx-bg-gray-700
          dark:hover:nx-text-gray-200
        " href="/tags/Tooling">Tooling</a></div></div><div class="nx-flex nx-items-center nx-gap-3 print:nx-hidden"><a href="/posts">Back</a></div></div><p><a href="https://github.com/release-it/release-it" target="_blank" rel="noreferrer">Release It!<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> is a tool to automate releases for npm packages. It can be used to automatically bump the version, generate changelog based, create a git tag, push the changes to the repository, and publish the package to npm.</p>
<p>The version bump and changelog generation is based on the commit messages. It uses <a href="https://www.conventionalcommits.org/en/v1.0.0/" target="_blank" rel="noreferrer">Conventional Commits<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> by default.</p>
<p>This guide documents how to configure GitHub Actions to automatically release npm packages on every commit using <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">release-it</code>.</p>
<h2 class="nx-not-prose subheading-h2">Step 1<a href="#step-1" id="step-1" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<p>Install <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">release-it</code> and <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">@release-it/conventional-changelog</code> as dev dependencies:</p>
<div class="nx-not-prose"><div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="bash" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="bash" data-theme="default"><span class="line"><span style="color:var(--shiki-token-function)">yarn</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string)">add</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string)">--dev</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string)">release-it</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string)">@release-it/conventional-changelog</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div></div>
<p>Configure <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">release-it</code> in the <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">package.json</code> file:</p>
<div class="nx-not-prose"><div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="js" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="js" data-theme="default"><span class="line"><span style="color:var(--shiki-color-text)">{</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">...</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">&quot;release-it&quot;</span><span style="color:var(--shiki-color-text)">: {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-string-expression)">&quot;git&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      </span><span style="color:var(--shiki-token-string-expression)">&quot;commitMessage&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;chore: release ${version}&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      </span><span style="color:var(--shiki-token-string-expression)">&quot;tagName&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;v${version}&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-string-expression)">&quot;npm&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      </span><span style="color:var(--shiki-token-string-expression)">&quot;publish&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">true</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-string-expression)">&quot;github&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      </span><span style="color:var(--shiki-token-string-expression)">&quot;release&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">true</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-string-expression)">&quot;plugins&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      </span><span style="color:var(--shiki-token-string-expression)">&quot;@release-it/conventional-changelog&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-string-expression)">&quot;preset&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">          </span><span style="color:var(--shiki-token-string-expression)">&quot;name&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;conventionalcommits&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-string-expression)">&quot;infile&quot;</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;CHANGELOG.md&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">...</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div></div>
<h2 class="nx-not-prose subheading-h2">Step 2<a href="#step-2" id="step-2" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<p>Create a NPM token with publish access. You can create one at <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">https://www.npmjs.com/settings/[username]/tokens</code> (replace <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">[username]</code> with your username):</p>
<ul>
<li>Click on <strong>&quot;Generate New Token&quot;</strong> and select <strong>&quot;Granular Access Token&quot;</strong></li>
<li>Provide a token name and expiration date</li>
<li>Under <strong>&quot;Packages and scopes&quot;</strong>, select <strong>&quot;Read and write&quot;</strong> for permissions</li>
<li>Then select <strong>&quot;Only select packages and scopes&quot;</strong> and select the package you want to publish</li>
<li>Click <strong>&quot;Generate token&quot;</strong> and copy the token</li>
</ul>
<p>Then the token needs to be added as a secret in the GitHub repository:</p>
<ul>
<li>Go to the repository and click on <strong>&quot;Settings&quot;</strong></li>
<li>Click on <strong>&quot;Secrets and variables&quot;</strong> and choose <strong>&quot;Actions&quot;</strong></li>
<li>Click <strong>&quot;New repository secret&quot;</strong> and add the token as <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">NPM_PUBLISH_TOKEN</code></li>
<li>Click on <strong>&quot;Add secret&quot;</strong> to save the token</li>
</ul>
<p>This token will be used to authenticate with NPM to publish the package.</p>
<h2 class="nx-not-prose subheading-h2">Step 3<a href="#step-3" id="step-3" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<p>Create a GitHub personal access token with the <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">repo</code> scope. You can create one at <a href="https://github.com/settings/tokens/new?scopes=repo&amp;description=release-it" target="_blank" rel="noreferrer">https://github.com/settings/tokens/new?scopes=repo&amp;description=release-it<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a>.</p>
<p>Then the token needs to be added as a secret in the GitHub repository:</p>
<ul>
<li>Go to the repository and click on <strong>&quot;Settings&quot;</strong></li>
<li>Click on <strong>&quot;Secrets and variables&quot;</strong> and choose <strong>&quot;Actions&quot;</strong></li>
<li>Click <strong>&quot;New repository secret&quot;</strong> and add the token as <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">PERSONAL_ACCESS_TOKEN</code></li>
<li>Click on <strong>&quot;Add secret&quot;</strong> to save the token</li>
</ul>
<p>A personal access token is necessary to be able to push the changes back to the repository if the release branch is protected. The user associated with the token needs to have admin access to the repository and be able to bypass branch protection rules.</p>
<p><strong>Keep in mind that other collaborators on the repo can push actions that use this token and push commits acting as the user associated with the token.</strong></p>
<p>If there are no branch protection rules in the repository, then the <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">GITHUB_TOKEN</code> secret can be used instead of a personal access token.</p>
<h2 class="nx-not-prose subheading-h2">Step 4<a href="#step-4" id="step-4" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<p>Create a GitHub Actions workflow file in <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">.github/workflows/release.yml</code> with the following contents:</p>
<div class="nx-not-prose"><div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="yml" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="yml" data-theme="default"><span class="line"><span style="color:var(--shiki-token-keyword)">name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">Release package</span></span>
<span class="line"><span style="color:var(--shiki-token-constant)">on</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">workflow_run</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">branches</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      - </span><span style="color:var(--shiki-token-string-expression)">main</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">workflows</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      </span><span style="color:var(--shiki-token-comment)"># List of workflows that runs tests, linting, etc.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      </span><span style="color:var(--shiki-token-comment)"># This ensures that the release is only triggered when the tests pass.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      - </span><span style="color:var(--shiki-token-string-expression)">CI</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">types</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      - </span><span style="color:var(--shiki-token-string-expression)">completed</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-keyword)">jobs</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">check-commit</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">runs-on</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">ubuntu-latest</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)"># Skip if the workflow run for tests, linting etc. is not successful</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)"># Without this, the release will be triggered after the previous workflow run even if it failed.</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">${{ github.event.workflow_run.conclusion == &#x27;success&#x27; }}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">outputs</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      </span><span style="color:var(--shiki-token-keyword)">skip</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">${{ steps.commit-message.outputs.skip }}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">steps</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      - </span><span style="color:var(--shiki-token-keyword)">name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">Checkout</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">uses</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">actions/checkout@v3</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">      </span><span style="color:var(--shiki-token-comment)"># Check if the commit message is a release commit</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      </span><span style="color:var(--shiki-token-comment)"># Without this, there will be an infinite loop of releases</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      - </span><span style="color:var(--shiki-token-keyword)">name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">Get commit message</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">id</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">commit-message</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">run</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">|</span></span>
<span class="line"><span style="color:var(--shiki-token-string)">          MESSAGE=$(git log --format=%B -n 1 $(git log -1 --pretty=format:&quot;%h&quot;))</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-string)">          if [[ $MESSAGE == &quot;chore: release &quot;* ]]; then</span></span>
<span class="line"><span style="color:var(--shiki-token-string)">            echo &quot;skip=true&quot; &gt;&gt; $GITHUB_OUTPUT</span></span>
<span class="line"><span style="color:var(--shiki-token-string)">          fi</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">release</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">runs-on</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">ubuntu-latest</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">needs</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">check-commit</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)"># Skip if the commit message is a release commit</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">${{ needs.check-commit.outputs.skip != &#x27;true&#x27; }}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">steps</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">      - </span><span style="color:var(--shiki-token-keyword)">name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">Checkout</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">uses</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">actions/checkout@v3</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">with</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">          </span><span style="color:var(--shiki-token-comment)"># This is needed to generate the changelog from commit messages</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">          </span><span style="color:var(--shiki-token-keyword)">fetch-depth</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">0</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">          </span><span style="color:var(--shiki-token-keyword)">token</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">${{ secrets.PERSONAL_ACCESS_TOKEN }}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">      - </span><span style="color:var(--shiki-token-keyword)">name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">Setup Node.js</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">uses</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">actions/setup-node@v3</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">      - </span><span style="color:var(--shiki-token-keyword)">name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">Install dependencies</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">run</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">yarn install --immutable</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">shell</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">bash</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">      - </span><span style="color:var(--shiki-token-keyword)">name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">Configure Git</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">run</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">|</span></span>
<span class="line"><span style="color:var(--shiki-token-string)">          git config user.name &quot;${GITHUB_ACTOR}&quot;</span></span>
<span class="line"><span style="color:var(--shiki-token-string)">          git config user.email &quot;${GITHUB_ACTOR}@users.noreply.github.com&quot;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">      - </span><span style="color:var(--shiki-token-keyword)">name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">Create release</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">run</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">|</span></span>
<span class="line"><span style="color:var(--shiki-token-string)">          npm config set //registry.npmjs.org/:_authToken $NPM_TOKEN</span></span>
<span class="line"><span style="color:var(--shiki-token-string)">          yarn release-it --ci</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">env</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">          </span><span style="color:var(--shiki-token-keyword)">GITHUB_TOKEN</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">${{ secrets.PERSONAL_ACCESS_TOKEN }}</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">          </span><span style="color:var(--shiki-token-keyword)">NPM_TOKEN</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">${{ secrets.NPM_PUBLISH_TOKEN }}</span></span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div></div>
<p>This workflow will automatically publish a new version of the package on every commit to the <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">main</code> branch. Make sure to go through the workflow file and modify it according to your needs, especially the <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">workflows</code> list in the <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">on</code> section.</p>
<p>Alternatively, instead of publishing on every commit, the <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">workflow_dispatch</code> event can be used to manually trigger the workflow from the Actions tab in the repository. See the <a href="https://docs.github.com/en/actions/using-workflows/manually-running-a-workflow" target="_blank" rel="noreferrer">documentation<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a> for more details.</p><p>Copyright © <!-- -->2023<!-- --> Satyajit Sahoo. All rights reserved.</p></article></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{}},"page":"/posts/automated-release-on-github-actions","query":{},"buildId":"b3OQLwQgKfblSc4uNaOEV","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>